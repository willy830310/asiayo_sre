- [題目二](#題目二)
  - [問題描述](#問題描述)
  - [問題回覆](#問題回覆)
    - [1. 檢查相關metrics](#1-檢查相關metrics)
    - [2. 檢查application的log](#2-檢查application的log)
    - [3. 檢查load balancing設定](#3-檢查load-balancing設定)
    - [4. 檢查infra的穩定性](#4-檢查infra的穩定性)
    - [5. 事後優化系統](#5-事後優化系統)

# 題目二
## 問題描述
試想有一個 API 伺服器集群,背後由多台機器組成,此時服務監控系統發現其中一台回應時間經常逾時,僅有此機器異常,請簡易描述你/妳將會如何進行問題排查?考量的細節是什麼?

## 問題回覆

大致上會用以下的順序去做排查

### 1. 檢查相關metrics
先檢查此台機器的基本metrics(CPU、 Memory、 Disk、 Networking)是否一切正常(與其他機器做比對)，一切正常的話可以先排除因為資源不足導致的效能低落問題([連結到2](#2-檢查application的log))，不正常的話可能是這台機器的workload比較重所導致的([連結到3](#3-檢查load-balancing設定))

---

### 2. 檢查application的log
看這台機器上面的application有沒有印出比較異常的log，如果服務有串接其他服務，要把其他服務的狀態也一併考慮進來，因為有可能是因為其他服務(EX: database)效能低落(database本體效能低落或者是SQL需要優化之類的)或者是連線中斷所導致application回應時間逾時

---

### 3. 檢查load balancing設定
考慮到只有這台機器經常逾時，大致上可以排除被攻擊的可能性(理論上會全部的機器一起癱瘓)，所以可能要檢查是否有load balancing的設定異常，導致request沒有合理的分配到整個API伺服器集群

---

### 4. 檢查infra的穩定性
如果不是機器跟application的問題，那可能就是在request透過網路傳輸時所造成的，會合理懷疑是否網路連線不穩或者是機器沒有發揮其原本的性能

---

### 5. 事後優化系統
根據此次事件發生的原因，規劃與設計取得相關的metrics，強化監控與告警系統，讓我們可以問題再發生時快速地做出反應

